#!/bin/sh

read_target() {
  if [ -e "$1" ]; then
    if [ -d "$1" ] && [ -f "$1/index.m3u" ]; then
      echo "$1/index.m3u"
      return
    fi
  fi
  if echo "$1" | grep "^http" >/dev/null; then
    case "$1" in
      *youtu.be*|*youtube*|*bandcamp*|*soundcloud*)
        yt-dlp --get-url "$1" -f bestaudio
        return;;
    esac
  fi
  echo "$1"
}

# tracks=""
# options=""
# for term in "$@"; do
#   case "$term" in
#     "--loop") options="$options --loop-playlist";;
#     *)
#       if [ "$tracks" = "" ]; then
#         tracks="$(read_target "$term")"
#       else
#           tracks="$tracks\n$(read_target "$term")"
#       fi;;
#   esac
# done

# echo "$tracks" | mpv --no-video --playlist=- "$options"
export TERM=xterm-256color 
# intf could be "cli"
vlc --no-loop --no-random --no-color --intf ncurses "$(read_target "$1")"
